"use strict";function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c&&(c=b.exec(location.hash)),null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}$().ready(function(){$.ajax({type:"GET",url:"config",success:function(a){var b=function(b){return a.protocol+"://"+a.host+a.port+a.context+b},c=function(){return a.mashape?{"X-Mashape-Key":a.xMashapeKey}:void 0},d=function(){a.log&&console.log(arguments)},e=function(a){$("#"+a+" form button[name=submit]").isLoading({tpl:'<span class="glyphicon glyphicon-refresh glyphicon-refresh-animate" ></span>'})},f=function(a){$("#"+a+" form button[name=submit]").isLoading("hide")},g=function(a){$(".subsection").hide(),$("#"+a).show()},h=function(){$(".subsection").hide()};$(".subsection").each(function(a,b){var c=$(b).attr("id");$("#links a[href=#"+c+"]").click(function(){g(c)})}),""!==window.location.hash&&-1===window.location.hash.indexOf("&")&&(h(),$(window.location.hash).show());var i=function(a){return function(b,c,e){d("error",b,c,e),a&&f(a),4===b.readyState?notie.alert(3,"Error ("+b.status+", "+b.statusText+")",5):0===b.readyState?notie.alert(3,"Network Error",5):notie.alert(3,"Error !",5)}};window.location.hash.startsWith("#confirm?")&&!function(){var a=getParameterByName("e"),e=getParameterByName("t");d("confirm "+a+" with token "+e),$.ajax({type:"PUT",url:b("confirmToken")+"/"+e,headers:c(),data:JSON.stringify({email:a}),success:function(a){d(a),notie.alert(1,"Success! You are confirmed",1.5)},error:i,contentType:"application/json;charset=UTF-8",dataType:"json"})}(),window.location.hash.startsWith("#reset-password?")&&!function(){var a=getParameterByName("e"),b=getParameterByName("t");d("password-lost "+a+" with token "+b),$("#reset-password form input[name=email]").val(a),$("#reset-password form input[name=token]").val(b),g("reset-password")}(),$("#reset-password form").validate({rules:{password:{required:!0}}}),$("#reset-password form").submit(function(a){if($(a.target).valid()){var g=$("#reset-password form input[name=email]").val(),j=$("#reset-password form input[name=token]").val(),k=$("#reset-password form input[name=password]").val();e("reset-password"),$.ajax({timeout:2e4,cache:!1,type:"PUT",url:b("lostToken/"+j),headers:c(),data:JSON.stringify({email:g,password:k}),success:function(a){d(a),notie.alert(1,"Password correctly changed",1.5),f("reset-password"),h()},error:i("signup"),contentType:"application/json;charset=UTF-8",dataType:"json"})}a.preventDefault()}),$("#signup form").validate({rules:{email:{required:!0,email:!0},password:{required:!0}}}),$("#signup form").submit(function(a){if($(a.target).valid()){var g=$("#signup form input[name=email]").val(),j=$("#signup form input[name=password]").val();e("signup"),$.ajax({timeout:2e4,cache:!1,type:"POST",url:b("user"),headers:c(),data:JSON.stringify({email:g,password:j,urlBaseConfirm:document.location.protocol+"//"+document.location.host+document.location.pathname+"#confirm",skipEmailSend:!1}),success:function(a){d(a),notie.alert(1,"Success! Check you email",1.5),f("signup"),h()},error:i("signup"),contentType:"application/json;charset=UTF-8",dataType:"json"})}a.preventDefault()}),$("#password-lost form").validate({rules:{email:{required:!0,email:!0}}}),$("#password-lost form").submit(function(a){if($(a.target).valid()){var g=$("#password-lost form input[name=email]").val();e("password-lost"),$.ajax({timeout:2e4,cache:!1,type:"POST",url:b("lostToken"),headers:c(),data:JSON.stringify({email:g,baseUrl:document.location.protocol+"//"+document.location.host+document.location.pathname+"#reset-password",skipEmailSend:!1}),success:function(a){d(a),notie.alert(1,"Check you email",1.5),f("password-lost"),h()},error:i("password-lost"),contentType:"application/json;charset=UTF-8",dataType:"json"})}a.preventDefault()}),$("#change-password form").validate({rules:{email:{required:!0,email:!0},"old-password":{required:!0},"new-password":{required:!0}}}),$("#change-password form").submit(function(a){if($(a.target).valid()){var g=$("#change-password form input[name=email]").val(),j=$("#change-password form input[name=old-password]").val(),k=$("#change-password form input[name=new-password]").val();e("change-password"),$.ajax({timeout:2e4,cache:!1,type:"PUT",url:b("user/"+g),headers:c(),data:JSON.stringify({oldPassword:j,newPassword:k}),success:function(a){d(a),notie.alert(1,"Password changed",1.5),f("change-password"),h()},error:i("change-password"),contentType:"application/json;charset=UTF-8",dataType:"json"})}a.preventDefault()}),$("#check form").validate({rules:{email:{required:!0,email:!0},password:{required:!0}}}),$("#check form").submit(function(a){if($(a.target).valid()){var g=$("#check form input[name=email]").val(),i=$("#check form input[name=password]").val();e("check"),$.ajax({timeout:2e4,cache:!1,type:"GET",url:b("user/"+g+"/"+i),headers:c(),success:function(a){d(a),notie.alert(1,"Login OK",1.5),f("check"),h()},error:function(a,b,c){var e="check";d("error",a,b,c),e&&f(e),404===a.status?notie.alert(3,"Wrong username or password",5):4===a.readyState?notie.alert(3,"Error ("+a.status+", "+a.statusText+")",5):0===a.readyState?notie.alert(3,"Network Error",5):notie.alert(3,"Error !",5)},contentType:"application/json;charset=UTF-8",dataType:"json"})}a.preventDefault()})},dataType:"json"})});